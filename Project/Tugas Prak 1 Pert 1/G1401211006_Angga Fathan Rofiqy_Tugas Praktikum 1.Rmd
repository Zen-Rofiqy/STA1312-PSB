---
title: "Tugas Praktikum 1"
author: "Angga Fathan Rofiqy"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  rmdformats::downcute:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: true
    highlight: tango
    code_folding: show
    toc_depth: 3
    number_sections: false
    toc_float:
      collapsed: true
      smooth_scroll: true
    fig_caption: true
pkgdown:
  as_is: true
---

```{r message=FALSE, warning=FALSE, include=FALSE}
#                      -=( Install & Load Package Function )=-
install_load <- function (package1, ...)  {   

   # convert arguments to vector
   packages <- c(package1, ...)

   # start loop to determine if each package is installed
   for(package in packages){

       # if package is installed locally, load
       if(package %in% rownames(installed.packages()))
          do.call('library', list(package))

       # if package is not installed locally, download, then load
       else {
          install.packages(package)
          do.call("library", list(package))
       }
   } 
}

install_load("DT","dplyr")
```

# No 1

![](images/clipboard-1509227410.png){width="619"}

> **Misalkan**
>
> -   `D` : Dena menyukai sebuah restoran
>
> -   `B5` : Restoran rating bintang 5 di OKfood
>
> -   `B4` : Restoran rating bintang 4 di OKfood
>
> -   `Bk` : Restoran rating bintang kurang dari 4 di OKfood

> **Diketahui**
>
> -   $P(D)=0.7$
>
> -   $P(B5|D)=0.2$
>
> -   $P(B4|D)=0.5$
>
> -   $P(Bk|D)=0.3$

> **Ditanya:** $P(D|Bk)$ ?

## Penyelesaian

Menggunakan **rumus bayes,**

$P(B_j|A) = \frac{P(A|B_j) \times P(B_j)} {P(A)}$, dimana $P(A)=\sum^k_{i=1} P(A|B_i) \times P(B_i)$

Maka,

$P(D|Bk) = \frac{P(Bk|D) \times P(D)} {P(Bk)} = \frac{0.3 \times 0.7} {P(Bk)}$

Dimana, $\begin{equation}\begin{aligned} P(Bk) &= P(Bk|D) \times P(D) \text{ } + \text{ } P(Bk|D^c) \times P(D^c) \\ &= (0.3 \times 0.7) \text{ } + \text{ } P(Bk|D^c) \times 0.3 \end{aligned}\end{equation}$

Bisa dilihat bahwa <mark style="background-color: #b6f2b6">informasi tambahan</mark> yang diperlukan apabila kita ingin mencari nilai $P(D|Bk)$ (Peluang Dena menyukai resto rating kurang dari 4) <mark style="background-color: #b6f2b6">adalah $P(Bk|D^c)$ (Persentase resto rating kurang dari 4 yang tidak disukai Dena).</mark>

# No 2

![](images/clipboard-291666876.png){width="577"}

## Poin a

Likelihood sebaran Poisson dengan $Y=2$ :

$$
P(Y=2|\mu)=\frac{e^{-\mu}\mu^2}{2!} \text{ , } \mu=1,2,3,4,5
$$

Karena setiap nilai memiliki bobot yang sama, maka untuk setiap $\mu$ prior nya sama. Sehingga :

$$
P(Y=2)=\frac{1}{5} \text{ , } \mu
$$

> <mark style="background-color: #b6f2b6">Tabel bayes box</mark>

| $\mu$ | Prior | Likelihood | Prior $\times$ Likelihood | Posterior |
|:-----:|:-----:|------------|---------------------------|-----------|
|   1   |  1/5  | 0.1839     | 0.0368                    | 0.2023    |
|   2   |  1/5  | 0.2707     | 0.0541                    | 0.2976    |
|   3   |  1/5  | 0.2240     | 0.0448                    | 0.2464    |
|   4   |  1/5  | 0.1465     | 0.0293                    | 0.1611    |
|   5   |  1/5  | 0.0842     | 0.0168                    | 0.0926    |
| Total |       |            | 0.1819                    |           |

## Poin b

```{r}
# Nilai ùúá yang mungkin
mu <- c(1,2,3,4,5)

# Prior untuk setiap nilai ùúá
pri <- rep(1/length(mu), length(mu))

# Dirstribusi Poisson
pois.llh <- function(k, mu) return(dpois(k, mu))

# Menghitung likelihood untuk Y=2 untuk setiap nilai ùúá
k <- 2
llh <- sapply(mu, pois.llh, k=k)

# Menghitung Prior x likelihood
pri.llh <- llh * pri

# Menghitung Posterior
post <- pri.llh / sum(pri.llh)

datatable( data.frame( mu, pri, llh, pri.llh, post ) ) %>% 
  formatRound(c('llh', 'pri.llh', 'post'), digits = 4)
```
